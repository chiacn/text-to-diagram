(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{57:function(e,t,r){Promise.resolve().then(r.bind(r,9984))},9984:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return M}});var s=r(7437),n=r(2265),a=r(8224);function l(e){let{items:t,selectedValue:r,changeInquiryType:n,gap:l=12}=e;return(0,s.jsx)(a.tX,{type:"single",onValueChange:e=>n(e),className:"flex",style:{gap:l},children:t.map(e=>(0,s.jsx)(a.GX,{value:e.value,className:"rounded-3xl text-sm font-medium transition-transform duration-200 p-5\n            ".concat(r===e.value?"bg-gray-700 text-gray-200 shadow-md scale-105":"bg-white-800 text-black-400 border border-gray-600 hover:bg-gray-700 hover:text-white opacity-80","\n          \n          "),children:e.label},e.value))})}var i=r(2169);let o=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...n})});function c(e){let{item:t,stepProgressItemRef:r,stepOffsetInfo:n,highlightColor:a,inquiryType:l}=e,i={example:["target","example","description","result"],logical_progression:["target","statement","description","implications"],tree:["target"]};return(0,s.jsx)("div",{className:"absolute",ref:r,style:{left:n.longestLinePosition+40,top:80},children:(0,s.jsxs)("div",{className:"w-[520px] rounded-xl shadow-lg border border-gray-200 p-4 my-4 transition-transform transform hover:scale-105 hover:shadow-xl cursor-pointer bg-white",children:[(0,s.jsxs)("div",{className:"text-xl font-bold text-gray-900 mb-2",children:["Step ",t.step]}),Object.entries(t).filter(e=>{let[t,r]=e,s=i[null!=l?l:"example"];return Array.isArray(s)&&s.includes(t.toLowerCase())}).map(e=>{let[t,r]=e;return"step"===t?null:(0,s.jsxs)("div",{className:"text-sm text-gray-600 mb-2",children:[(0,s.jsxs)("strong",{children:[t.charAt(0).toUpperCase()+t.slice(1),":"]}),(0,s.jsx)("span",{className:"ml-1 block max-h-[200px] overflow-y-scroll scrollbar-custom",children:"target"===t?(0,s.jsx)("span",{style:{backgroundColor:a},children:r}):"result"===t?JSON.stringify(r,(e,t)=>Array.isArray(t)?JSON.stringify(t).replace(/^\[|\]$/g,"").replace(/,/g,", "):t,2).replace(/"(\[.*?\])"/g,"$1").replace(/},/g,"},\n"):JSON.stringify(r)})]},t)})]})})}function d(e){let{totalSteps:t,currentStep:r,setCurrentStep:n}=e;return(0,s.jsx)("div",{className:"sticky top-4 text-right pointer-events-auto",children:(0,s.jsxs)("div",{className:"flex justify-end items-center space-x-1.5",children:[(0,s.jsx)("button",{onClick:()=>{r>0&&n(r-1)},disabled:0===r,className:"px-3 py-1 rounded-full font-medium shadow-sm transition-transform duration-200 ".concat(0===r?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-sky-100 text-sky-600 hover:bg-sky-200"),children:"← Prev"}),(0,s.jsxs)("span",{className:"px-3 py-1 text-sm font-semibold text-gray-600",children:[r+1," / ",t]}),(0,s.jsx)("button",{onClick:()=>{r<t-1&&n(r+1)},disabled:r>=t-1,className:"px-3 py-1 rounded-full font-medium shadow-sm transition-transform duration-200 ".concat(r>=t-1?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-sky-100 text-sky-600 hover:bg-sky-200"),children:"Next →"})]})})}function u(e){let{progressActive:t,focusSpreadedStep:r=[],currentStep:n,setCurrentStep:a}=e;return t&&(0,s.jsx)("div",{className:"absolute top-0 left-0 w-full h-full bg-transparent bg-opacity-75 z-10 rounded-lg p-4 pointer-events-none",children:(0,s.jsx)(d,{totalSteps:r.length,currentStep:n,setCurrentStep:a})})}function m(e){let{isPlaying:t,setIsPlaying:r}=e;return(0,s.jsx)("button",{onClick:()=>r(!t),className:"flex items-center px-2.5 py-1.5 bg-sky-200 text-gray-800 rounded-md hover:bg-sky-300 transition-transform duration-300 transform hover:scale-105 shadow-sm",children:t?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",stroke:"currentColor",className:"w-4 h-4 mr-1.5",children:[(0,s.jsx)("rect",{x:"6",y:"5",width:"4",height:"14"}),(0,s.jsx)("rect",{x:"14",y:"5",width:"4",height:"14"})]}),"stop"]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",viewBox:"0 0 24 24",stroke:"currentColor",className:"w-4 h-4 mr-1.5",children:(0,s.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.752 11.168l-6.012-3.606A1 1 0 007 8.388v7.224a1 1 0 001.74.808l6.012-3.606a1 1 0 000-1.664z"})}),"play"]})})}function g(e){let{submittedText:t,isOpenSubmittedText:r,setIsOpenSubmittedText:a,entireSpreadedStep:l,focusSpreadedStep:i,currentHighlightStatus:o,targetColorMap:d,inquiryType:g}=e,[h,p]=(0,n.useState)(t),{isPlaying:f,setIsPlaying:x,progressActive:v,highlightedTextByStep:y,currentStep:b,setCurrentStep:j,stepOffsetInfo:w,textContainerRef:N,isSmaller:S}=function(e){let{currentHighlightStatus:t,submittedText:r,focusSpreadedStep:a,targetColorMap:l,inquiryType:i}=e,[o,d]=(0,n.useState)(!1),[u,m]=(0,n.useState)(!1),[g,h]=(0,n.useState)(0),[p,f]=(0,n.useState)(r),[x,v]=(0,n.useState)(!1),[y,b]=(0,n.useState)({longestLinePosition:0,stepProgressItemHeight:0,highlightedTextPosition:0,submittedTextMinHeight:0,submittedTextMaxHeight:0,submittedTextRightPosition:0}),j=(0,n.useRef)(null),w=(0,n.useRef)(null),N=(0,n.useRef)(null),S=(0,n.useRef)(null),E=()=>{var e;if("tree"===i){I();return}let t=[null==a?void 0:null===(e=a[g])||void 0===e?void 0:e.target];f(T(r,null!=t?t:[]))},I=()=>{if((null==a?void 0:a.length)===0)return;let e=null==a?void 0:a.map(e=>e.element_name);f(T(r,null!=e?e:[]))},C=e=>null==e?void 0:e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),T=(e,t)=>{if(!a||0===a.length||!t||0===t.length)return e;let r=t.map(e=>C(e)),n=RegExp("(".concat(r.join("|"),")"),"gi"),o=!1,d=null,u=e.split(n);return(0,s.jsxs)("span",{ref:S,children:[u.map((e,r)=>{let n=t.find(t=>(null==e?void 0:e.toLowerCase())===(null==t?void 0:t.toLowerCase()));return n&&!o?("tree"!==i&&(o=!0),d=l[n]||"#fef3c7",(0,s.jsx)("span",{children:(0,s.jsx)("span",{style:{backgroundColor:d},ref:w,children:e},"progress-".concat(r))},"fragment-".concat(r))):(0,s.jsx)("span",{children:e},"part-".concat(r))}),"tree"!==i&&(0,s.jsx)(c,{item:null==a?void 0:a[g],stepProgressItemRef:N,stepOffsetInfo:y,highlightColor:null!=d?d:"",inquiryType:i},"progress-item")]})},k=()=>{d(!1),m(!1),h(0),b({longestLinePosition:0,stepProgressItemHeight:0,highlightedTextPosition:0,submittedTextMinHeight:0,submittedTextMaxHeight:0,submittedTextRightPosition:0})};(0,n.useEffect)(()=>{0!==t&&"tree"===i?(m(!0),E()):(0===t||1===t)&&k()},[t,a]),(0,n.useEffect)(()=>{u&&E()},[u,g,y.longestLinePosition]),(0,n.useEffect)(()=>{switch(t){case 0:case 1:case 2:o?m(!0):k();break;default:k()}},[o]),(0,n.useLayoutEffect)(()=>{"tree"!==i&&(_(),O())},[p]);let O=()=>{w.current&&w.current.scrollIntoView({behavior:"smooth",block:"nearest",inline:"nearest"})},P=(e,t)=>{let r="tree"!==i&&e-t<400;v(e=>e||r)},_=()=>{if(w.current){let e=w.current.getBoundingClientRect();b(t=>({...t,highlightedTextPosition:e.top}))}if(N.current){let e=N.current.getBoundingClientRect();b(t=>({...t,stepProgressItemHeight:e.height}))}if(S.current){var e,t;let r=Math.floor((null===(e=j.current)||void 0===e?void 0:e.getBoundingClientRect().right)||0);null===(t=j.current)||void 0===t||t.getBoundingClientRect().left;let s=Number(S.current.offsetWidth);P(r,s),b(e=>{var t,n;return{...e,longestLinePosition:s,submittedTextMinHeight:(null===(t=j.current)||void 0===t?void 0:t.clientHeight)||0,submittedTextMaxHeight:(null===(n=j.current)||void 0===n?void 0:n.scrollHeight)||0,submittedTextRightPosition:r}})}};return{isPlaying:o,setIsPlaying:d,progressActive:u,highlightedTextByStep:p,currentStep:g,setCurrentStep:h,stepOffsetInfo:y,textContainerRef:j,isSmaller:x}}({currentHighlightStatus:o,submittedText:t,focusSpreadedStep:i,targetColorMap:d,inquiryType:g});(0,n.useEffect)(()=>{console.log("uiInfo ---- ",w)},[w]);let E=e=>null==e?void 0:e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),I=(e,t)=>{if(!t||0===t.length)return e;let r=t.map(e=>E(e)),n=RegExp("(".concat(r.join("|"),")"),"gi");return e.split(n).map((e,r)=>{let n=t.find(t=>(null==e?void 0:e.toLowerCase())===(null==t?void 0:t.toLowerCase()));if(!n)return(0,s.jsx)("span",{children:e},"submitted-".concat(r));{let t=d[n]||"#fef3c7";return(0,s.jsx)("span",{style:{backgroundColor:t},children:e},"submitted-".concat(r))}})},C=()=>{if(0===o){p(t);return}let e=null==i?void 0:i.map(e=>e.target);p(I(t,null!=e?e:[]))};return(0,n.useEffect)(()=>{C()},[i]),(0,s.jsx)("div",{className:"w-full relative",children:(0,s.jsxs)("div",{className:"w-full mt-8 bg-white border border-gray-300 rounded-lg shadow-lg ".concat(t?"opacity-100 max-h-[500px] scale-100":"opacity-0 max-h-0 scale-95"),children:[(0,s.jsxs)("div",{className:"flex items-center p-2 bg-gray-100 border-b border-gray-300 ".concat("tree"===g?"justify-end":"justify-between"),children:["tree"!==g&&(0,s.jsx)(m,{isPlaying:f,setIsPlaying:x}),(0,s.jsx)("button",{onClick:()=>a(!r),className:"text-gray-600 hover:text-gray-800 transition-transform duration-300 transform",children:(0,s.jsx)("span",{className:"inline-block transition-transform duration-300 ".concat(r?"rotate-180":"rotate-0"),children:"▲"})})]}),(0,s.jsxs)("div",{ref:N,className:"transition-all duration-500 transform whitespace-pre-wrap text-left p-4 relative ".concat(r?"opacity-100 max-h-[400px] scale-100":"opacity-0 max-h-0 scale-95 pointer-events-none"),style:{overflowX:"visible"},children:[(0,s.jsx)("div",{className:"inner-container overflow-y-scroll scrollbar-custom ",style:{maxHeight:v&&S?"330px":"380px",overflowX:"hidden",width:v&&S?"calc(100% - 300px)":"100%",marginTop:v&&S?"40px":""},children:v?y:h}),"tree"!==g&&(0,s.jsx)(u,{progressActive:v,focusSpreadedStep:i,currentStep:b,setCurrentStep:j})]})]})})}function h(e){let{diagramId:t,step:r,parentDiagramId:a,depth:l,target:i,example:o,description:c,result:d,handleDiagramItem:u,highlightItems:m,highlightColor:g,children:h}=e,[p,f]=(0,n.useState)(!1),x=e=>{e.stopPropagation(),u("highlight",{diagramId:t,depth:l,parentDiagramId:a})},v=()=>{var e;f(null!==(e=null==m?void 0:m.includes(t))&&void 0!==e&&e)};return(0,n.useEffect)(()=>{v()},[m]),(0,s.jsxs)("div",{className:"rounded-xl border-[1px] p-4 my-2 transition-all duration-300 transform cursor-pointer\n                   ml-".concat(5*l),style:{backgroundColor:p?g:"white"},onClick:e=>x(e),children:[(0,s.jsxs)("div",{className:"text-lg font-semibold text-gray-800 mb-2",children:["Step ",r]}),(0,s.jsxs)("div",{className:"text-gray-700",children:[(0,s.jsx)("strong",{children:"Target:"})," ",i]}),(0,s.jsxs)("div",{className:"text-gray-700",children:[(0,s.jsx)("strong",{children:"Example:"})," ",o]}),(0,s.jsxs)("div",{className:"text-gray-700",children:[(0,s.jsx)("strong",{children:"Description:"})," ",c]}),(0,s.jsxs)("div",{className:"text-gray-700",children:[(0,s.jsx)("strong",{children:"Result:"})," ",JSON.stringify(d)]}),(0,s.jsx)("div",{className:"mt-3",children:h})]})}function p(e){let{diagramId:t,step:r,parentDiagramId:a,depth:l,target:i,statement:o,description:c,implications:d,handleDiagramItem:u,highlightItems:m,highlightColor:g}=e,[h,p]=(0,n.useState)(!1),f=e=>{e.stopPropagation(),u("highlight",{diagramId:t,depth:l,parentDiagramId:a})},x=()=>{var e;p(null!==(e=null==m?void 0:m.includes(t))&&void 0!==e&&e)};return(0,n.useEffect)(()=>{x()},[m]),(0,s.jsxs)("div",{className:"rounded-lg border p-4 my-3 transition-all duration-300 transform cursor-pointer ".concat(h?"shadow-md":""),style:{backgroundColor:h?g:"#ffffff",marginLeft:"".concat(20*l,"px"),borderColor:h?g:"#e5e7eb"},onClick:e=>f(e),children:[(0,s.jsxs)("div",{className:"text-lg font-semibold text-gray-800 mb-2",children:["Step ",r]}),(0,s.jsxs)("div",{className:"text-sm text-gray-600 mb-2",children:[(0,s.jsx)("strong",{className:"text-gray-700",children:"Target:"})," ",i]}),(0,s.jsxs)("div",{className:"text-sm text-gray-600 mb-2",children:[(0,s.jsx)("strong",{className:"text-gray-700",children:"Statement:"})," ",o]}),(0,s.jsxs)("div",{className:"text-sm text-gray-600 mb-2",children:[(0,s.jsx)("strong",{className:"text-gray-700",children:"Description:"})," ",c]}),(0,s.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,s.jsx)("strong",{className:"text-gray-700",children:"Implications:"})," ",d]})]})}o.displayName="Textarea";var f=r(8641),x=r(7252),v=e=>{let{diagramId:t,elementName:r,relationTypeWithParent:a,description:l,relationship:i,depth:o,parentDiagramId:c,handleDiagramItem:d,highlightItems:u,highlightColor:m,children:g}=e,[h,p]=(0,n.useState)(!1),[v,y]=(0,n.useState)(!1),b=()=>{var e;p(null!==(e=null==u?void 0:u.includes(t))&&void 0!==e&&e)};return(0,n.useEffect)(()=>{b()},[u]),(0,s.jsxs)("div",{className:"relative rounded-3xl border-[1px] p-4 my-2 transition-all duration-300 transform cursor-pointer max-w-[400px] min-w-[180px]\n                 ml-".concat(5*o," bg-white ").concat(v?"":"max-w-min max-h-min"),style:{backgroundColor:h?m:"white"},onClick:e=>{e.stopPropagation(),d("highlight",{diagramId:t,depth:o,parentDiagramId:c})},children:[(0,s.jsx)("button",{onClick:e=>{e.stopPropagation(),y(e=>!e)},className:"absolute top-2 right-2 hover:bg-gray-200 rounded p-1 flex items-center justify-center",style:{width:"20px",height:"20px"},children:v?(0,s.jsx)(x.wQF,{}):(0,s.jsx)(f.v3P,{})}),(0,s.jsx)("div",{className:"text-lg font-semibold text-gray-800 mb-2 mt-2 ml-4 mr-6",children:r}),(0,s.jsxs)("div",{className:"transition-all duration-300 overflow-hidden ".concat(v?"max-h-min opacity-100":"max-h-0 opacity-0"),children:[a&&(0,s.jsxs)("div",{className:"text-gray-700",children:[(0,s.jsx)("strong",{children:"Relationship with Parent:"})," ",a]}),(0,s.jsxs)("div",{className:"text-gray-700",children:[(0,s.jsx)("strong",{children:"Description:"})," ",l]}),i&&i.length>0&&(0,s.jsxs)("div",{className:"text-gray-700",children:[(0,s.jsx)("strong",{children:"Relationships:"})," ",JSON.stringify(i)]}),(0,s.jsx)("div",{className:"mt-3",children:g})]})]})},y=r(9143);let b=(0,r(7742).j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),j=n.forwardRef((e,t)=>{let{className:r,variant:n,size:a,asChild:l=!1,...o}=e,c=l?y.g7:"button";return(0,s.jsx)(c,{className:(0,i.cn)(b({variant:n,size:a,className:r})),ref:t,...o})});j.displayName="Button";var w=r(9580);function N(e){let{onClick:t,className:r,variant:n="default",isLoading:a,children:l}=e;return(0,s.jsx)(s.Fragment,{children:a?(0,s.jsx)(j,{variant:n,className:r,disabled:!0,children:(0,s.jsx)(w.Z,{className:"animate-spin"})}):(0,s.jsx)(j,{variant:n,className:r,onClick:()=>t(),children:l})})}function S(e){let{getCopyPrompt:t,submitPrompt:r,setIsOpen:a}=e,[l,i]=(0,n.useState)(""),[c,d]=(0,n.useState)(""),[u,m]=(0,n.useState)(!1),g=async()=>{(await r(c,l)).result&&a(!1)},h=async e=>{m(!0),await t(e),m(!1)};return(0,s.jsxs)("div",{className:"m-8",children:[(0,s.jsxs)("h3",{className:"mb-2 text-[16px] text-gray-80",children:["Use the copied prompt to generate JSON output using GPT or another LLM.",(0,s.jsx)("br",{}),"The input text for JSON should be filled in this textarea."]}),(0,s.jsxs)("div",{className:"flex justify-center items-center gap-4 mb-8",children:[(0,s.jsx)(o,{name:"Input your question to get prompt.",rows:4,cols:40,value:l,onChange:e=>i(e.target.value),className:"border border-gray-300 flex-4 w-full h-[90px] min-w-[600px]",placeholder:"Input your question to get prompt."}),(0,s.jsx)(N,{onClick:()=>h(l),className:"min-w-[124px] h-20 ml-2 flex-1 justify-center item-center",isLoading:u,variant:"outline",children:"Get Prompt"})]}),(0,s.jsx)("h3",{className:"mb-2 text-[16px] text-gray-80",children:"Use the generated JSON"}),(0,s.jsxs)("div",{className:"flex justify-center items-center gap-4",children:[(0,s.jsx)(o,{name:"Follow the specified JSON format.",rows:4,cols:40,value:c,onChange:e=>d(e.target.value),className:"border border-gray-300 flex-4 w-full h-[90px]",placeholder:"Follow the specified JSON format."}),(0,s.jsx)(j,{variant:"secondary",className:"w-40 h-20 ml-2 flex-1 justify-center item-center border",onClick:()=>g(),children:"Submit JSON"})]})]})}var E=r(8709),I=r(2235);let C=E.fC,T=E.xz,k=E.h_;E.x8;let O=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)(E.aV,{ref:t,className:(0,i.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",r),...n})});O.displayName=E.aV.displayName;let P=n.forwardRef((e,t)=>{let{className:r,children:n,...a}=e;return(0,s.jsxs)(k,{children:[(0,s.jsx)(O,{}),(0,s.jsxs)(E.VY,{ref:t,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",r),...a,children:[n,(0,s.jsxs)(E.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,s.jsx)(I.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});P.displayName=E.VY.displayName;let _=e=>{let{className:t,...r}=e;return(0,s.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",t),...r})};_.displayName="DialogHeader";let A=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)(E.Dx,{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",r),...n})});A.displayName=E.Dx.displayName;let R=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)(E.dk,{ref:t,className:(0,i.cn)("text-sm text-muted-foreground",r),...n})});function D(e){let{getCopyPrompt:t,submitPrompt:r}=e,[a,l]=(0,n.useState)(!1);return(0,s.jsxs)(C,{open:a,onOpenChange:l,children:[(0,s.jsx)(T,{asChild:!0,children:(0,s.jsx)(j,{variant:"outline",className:"w-32 h-[90px] ml-2 flex-1 justify-center item-center",children:"Copy Prompt"})}),(0,s.jsxs)(_,{children:[(0,s.jsx)(A,{}),(0,s.jsx)(R,{})]}),(0,s.jsx)(P,{className:"min-w-fit",children:(0,s.jsx)(S,{getCopyPrompt:t,submitPrompt:r,setIsOpen:l})})]})}R.displayName=E.dk.displayName;var L=r(6862);function M(){let{getAnswerFromModel:e,inquiryType:t,setInquiryType:r,inquiryTypeList:a,getPromptByInputText:i}=function(e){let{model:t="llama3-groq-70b-8192-tool-use-preview",service:r="groq"}=e,[s,a]=(0,n.useState)(null),l=()=>s?{result:!0,message:"Success"}:{result:!1,message:"Please select inquiry type."},i=async e=>{try{let{result:t,message:r}=l();if(!t)throw Error(r);let n=await fetch("/api/llm",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({input:e,inquiryType:s,serviceInfo:{},getOnlyPrompt:!0})});if(!n.ok)throw Error("Failed to fetch data");return(await n.json()).output.kwargs.content}catch(e){throw{variant:"warning",message:null==e?void 0:e.message}}};return{getAnswerFromModel:async(e,t)=>{try{let{result:t,message:r}=l();if(!t)throw Error(r);let n=await fetch("/api/llm",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({input:e,inquiryType:s,serviceInfo:{service:"groq",model:"llama3-groq-70b-8192-tool-use-preview"}})});if(!n.ok)throw Error("Failed to fetch data");let a=await n.json();return console.log("output --- ",a.output),a.output}catch(e){throw{variant:"warning",message:null==e?void 0:e.message}}},inquiryType:s,setInquiryType:a,inquiryTypeList:[{value:"tree",label:"Tree"},{value:"example",label:"Example"},{value:"logical_progression",label:"Logical Progression"}],getPromptByInputText:i}}({}),[c,d]=(0,n.useState)(""),[u,m]=(0,n.useState)(null),[f,x]=(0,n.useState)(""),[y,b]=(0,n.useState)(!1),{highlightItems:j,handleDiagramItem:w,diagramItemsListRef:S,currentHighlightStatus:E,colorPalette:I,targetColorMap:C,resetHighlight:T}=function(e){let{inquiryType:t}=e,[r,s]=(0,n.useState)([]),a=(0,n.useRef)([]),l={NONE:0,SAME_DEPTH:1,SEPARATE_COLOR:2,SINGLE_STEP:3},[i,o]=(0,n.useState)({value:0}),c=(0,n.useRef)({});return a.current=[],{handleDiagramItem:(e,n)=>{if("highlight"===e){if("logical_progression"===t){let e;s(e=r.includes(n.diagramId)?r.filter(e=>e!==n.diagramId):[...r,n.diagramId]),e.length>0?o({value:l.SEPARATE_COLOR}):o({value:l.NONE});return}let{parentDiagramId:e}=n,c=a.current.filter(t=>t.parentDiagramId===e).map(e=>e.diagramId);function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return({[l.NONE]:[],[l.SAME_DEPTH]:[...t],[l.SEPARATE_COLOR]:[...r,...t],[l.SINGLE_STEP]:[n.diagramId]})[e]||[]}r.length>0&&c.some(e=>!r.includes(e))?(o({value:0}),s(i(0,c))):o(e=>{let t={value:(e.value+1)%4};return s(i(t.value,c)),t})}},highlightItems:r,diagramItemsListRef:a,currentHighlightStatus:i,colorPalette:["#E3FDFD","#D4F3EF","#F9E2E3","#F0F7EE","#D2E4F2"],targetColorMap:c,resetHighlight:()=>{s([]),o({value:0})}}}({inquiryType:t}),{setSpreadSteps:k,entireSpreadedStep:O,focusSpreadedStep:P,assignDiagramIds:_,resetDataStructure:A}=function(e){let{highlightItems:t,currentHighlightStatus:r,structure:s,inquiryType:a}=e,[l,i]=(0,n.useState)([]),[o,c]=(0,n.useState)([]),d=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if("tree"===a){let r="".concat(t,"-").concat(e.content?"root":e.element_name);return e.diagramId=r,e.content&&e.content.length>0?e.content.forEach(e=>{d(e,t+1)}):e.related_elements&&e.related_elements.length>0&&e.related_elements.forEach(e=>{d(e,t+1)}),e}let r="".concat(t,"-").concat(e.step||"root");return e.diagramId=r,e.steps&&e.steps.length>0&&e.steps.forEach(e=>{d(e,t+1)}),e};return(0,n.useEffect)(()=>{t.length>0&&l.length>0?c([...l&&0!==t.length?l.filter(e=>t.includes(e.diagramId)):l]):c([...l])},[r,s]),{setSpreadSteps:e=>{if(i([]),c([]),e){let t=function e(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t&&(r.push(t),"tree"===a?t.content&&t.content.length>0?t.content.forEach(t=>{e(t,r)}):t.related_elements&&t.related_elements.length>0&&t.related_elements.forEach(t=>{e(t,r)}):t.steps&&t.steps.length>0&&t.steps.forEach(t=>{e(t,r)})),r}(e);("logical_progression"===a||"tree"===a)&&t.shift(),i([...t]),c([...t])}},entireSpreadedStep:l,focusSpreadedStep:o,assignDiagramIds:d,resetDataStructure:()=>{i([]),c([])}}}({highlightItems:j,currentHighlightStatus:E,structure:u,inquiryType:t}),{renderDiagramItems:R}=function(e){let{diagramItemsListRef:t,currentHighlightStatus:r,colorPalette:a,targetColorMap:l,handleDiagramItem:i,highlightItems:o,inquiryType:c}=e,d=(0,n.useRef)(null),u=e=>2===r.value?a[e%a.length]:"#fef3c7",m=function(e){var r;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0,c=0===n,g=c?"root":a,p=t.current.length;t.current.push({diagramId:e.diagramId,parentDiagramId:g});let f=u(p);return l.current[e.target]=f,(0,s.jsx)("div",{className:"flex ".concat(n>0?"pl-5":""," flex-row space-x-4"),ref:c?d:null,children:(0,s.jsx)(h,{diagramId:e.diagramId,step:e.step,parentDiagramId:g,depth:n,target:e.target,example:e.example,description:e.description,result:e.result,handleDiagramItem:i,highlightItems:o,highlightColor:f,children:null===(r=e.steps)||void 0===r?void 0:r.map(t=>m(t,n+1,e.diagramId))})},"".concat(n,"-").concat(e.step))},g=function(e){var r;let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return(0,s.jsxs)("div",{className:"mt-8 mb-8 flex flex-col space-y-6",ref:0===n?d:null,children:[e.title&&(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)("div",{className:"w-1 h-8 bg-gray-300 rounded-full"}),(0,s.jsx)("h2",{className:"text-2xl font-semibold text-gray-900 ml-4 flex items-center",children:e.title})]}),null===(r=e.steps)||void 0===r?void 0:r.map((e,r)=>{let c=e.diagramId,d=t.current.length;t.current.push({diagramId:c,parentDiagramId:a||"root"});let m=u(d);return l.current[e.target]=m,(0,s.jsx)(p,{diagramId:c,step:e.step,parentDiagramId:a,depth:n+1,target:e.target,statement:e.statement,description:e.description,implications:e.implications,handleDiagramItem:i,highlightItems:o,highlightColor:m},r)}),e.conclusion&&(0,s.jsxs)("div",{className:"ml-4 p-4 bg-white border border-gray-300 rounded-lg shadow-sm",children:[(0,s.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Conclusion"}),(0,s.jsx)("p",{className:"text-gray-700",children:e.conclusion})]})]})},f=e=>{if(!e.content||!Array.isArray(e.content))return null;let r=(e,n,a)=>{let c=e.diagramId,m=0===n;t.current.push({diagramId:c,parentDiagramId:a||"root"});let g=u(t.current.length-1);return l.current[e.element_name]=g,(0,s.jsx)("div",{className:"flex ".concat(n>0?"pl-5":""," flex-row space-x-4"),ref:m?d:null,children:(0,s.jsx)(v,{diagramId:c,elementName:e.element_name,relationTypeWithParent:e.relationTypeWithParent,description:e.description,relationship:e.relationship,depth:n,parentDiagramId:a,handleDiagramItem:i,highlightItems:o,highlightColor:g,children:e.related_elements&&e.related_elements.map(e=>r(e,n+1,c))})},c)};return(0,s.jsx)("div",{className:"flex flex-row flex-wrap gap-4",children:e.content.map(e=>r(e,0,"root"))})};return{renderDiagramItems:e=>{switch(c){case"tree":return f(e);case"example":default:return m(e);case"logical_progression":return g(e)}},contentWrapperRef:d}}({diagramItemsListRef:S,currentHighlightStatus:E,colorPalette:I,targetColorMap:C,handleDiagramItem:w,highlightItems:j,inquiryType:t}),[M,F]=(0,n.useState)(!1),J=async e=>{try{let t=await i(e);await navigator.clipboard.writeText(t||""),(0,L.Am)({variant:"info",description:"Copied!"})}catch(e){(0,L.Am)({variant:e.variant?e.variant:"destructive",description:null==e?void 0:e.message})}},H=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{F(!0);let s=(null===t?await e(c):t).match(/{[\s\S]*}/),n=(s?s[0]:"{}").replace(/"step":\s*([\d.]+)/g,'"step": "$1"'),a=q(n);if(!a.result)throw Error(a.message);V();let l=JSON.parse(n);return m({..._(l)}),t&&r?x(r):x(c),b(!0),k({..._(l)}),{result:!0,message:"Success!"}}catch(e){return V(),(0,L.Am)({variant:e.variant?e.variant:"destructive",description:null==e?void 0:e.message}),console.error("Failed to parse JSON:",e),{result:!1,message:e.message}}finally{F(!1)}},q=e=>{try{return z(),function(){try{JSON.parse(e.trim())}catch(e){throw console.error("error :: ",e),{result:!1,message:"Invalid JSON format."}}}(),function(e){let r=Object.keys(JSON.parse(e)),s={example:["target","example","steps"],tree:["content"],logical_progression:["steps"]}[null!=t?t:"example"];if(!s)throw{result:!1,message:"Invalid inquiry type. Please try again."};let n=s.find(e=>!r.includes(e));if(n)throw{result:!1,message:"A required key is missing in the JSON: ".concat(n,". Please try again.")}}(e),{result:!0,message:"Success!"}}catch(e){return{result:!1,message:e.message}}},z=()=>{if(!t)throw{result:!1,message:"Please select inquiry type."};return{result:!0,message:"Success"}},V=()=>{m(null),x(""),b(!1),T(),A()},[W,B]=(0,n.useState)(0),$=(0,n.useRef)(null);(0,n.useEffect)(()=>{let e=()=>{$.current&&(console.log("contentWrapperRef.current.offsetWidth",$.current.offsetWidth),B($.current.offsetWidth+40))};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}},[]);let G=(0,n.useRef)(null),U=(0,n.useRef)(null),X=e=>{"top"===e?U.current.scrollLeft=G.current.scrollLeft:G.current.scrollLeft=U.current.scrollLeft};return(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex flex-col justify-center items-center w-[80vw]",style:{maxWidth:"".concat(!W||W<500?1e3:W,"px")},children:[(0,s.jsx)(l,{items:a,selectedValue:t,changeInquiryType:e=>{m(null),x(""),b(!1),T(),A(),r(e)},gap:80}),(0,s.jsxs)("div",{className:"flex w-full mt-4",children:[(0,s.jsx)(o,{name:"postContent",rows:4,cols:40,onChange:e=>d(e.target.value),className:"border border-gray-300 flex-4 w-full h-[90px]"}),(0,s.jsx)(N,{onClick:H,className:"min-w-[90px] h-[90px] ml-2 flex-1 justify-center item-center",isLoading:M,children:"Submit"}),(0,s.jsx)(D,{getCopyPrompt:J,submitPrompt:H})]})]}),(0,s.jsxs)("div",{className:"sticky top-0 z-20",children:[(0,s.jsx)(g,{submittedText:f,isOpenSubmittedText:y,setIsOpenSubmittedText:b,currentHighlightStatus:E.value,entireSpreadedStep:O,focusSpreadedStep:P,targetColorMap:C.current,inquiryType:t}),(0,s.jsx)("div",{ref:G,onScroll:()=>X("top"),className:"scrollbar-custom w-[80vw] mt-2",children:(0,s.jsx)("div",{className:"h-[2px]",style:{width:"".concat(W,"px")}})})]}),(0,s.jsx)("div",{ref:U,onScroll:()=>X("bottom"),className:"scrollbar-custom w-[80vw] min-h-min flex flex-col overflow-x-auto",children:u&&R(u)})]})}},6862:function(e,t,r){"use strict";r.d(t,{Am:function(){return u},pm:function(){return m}});var s=r(2265);let n=0,a=new Map,l=e=>{if(a.has(e))return;let t=setTimeout(()=>{a.delete(e),d({type:"REMOVE_TOAST",toastId:e})},1e6);a.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?l(r):e.toasts.forEach(e=>{l(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},o=[],c={toasts:[]};function d(e){c=i(c,e),o.forEach(e=>{e(c)})}function u(e){let{...t}=e,r=(n=(n+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>d({type:"DISMISS_TOAST",toastId:r});return d({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||s()}}}),{id:r,dismiss:s,update:e=>d({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function m(){let[e,t]=s.useState(c);return s.useEffect(()=>(o.push(t),()=>{let e=o.indexOf(t);e>-1&&o.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>d({type:"DISMISS_TOAST",toastId:e})}}},2169:function(e,t,r){"use strict";r.d(t,{cn:function(){return a}});var s=r(3167),n=r(1367);function a(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,n.m6)((0,s.W)(t))}}},function(e){e.O(0,[305,614,453,575,971,69,744],function(){return e(e.s=57)}),_N_E=e.O()}]);